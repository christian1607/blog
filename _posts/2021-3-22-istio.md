---
layout: post
title: Istio Service Mesh
---

Istio is a really fantastic `service mesh`  open source solution which solves some problems like routing the traffic at the time of releasing a new version of our applications, authenticate any request comming from outside or internal communication, define service to service policies, establish a secure communication among our applications, and so on. 

Obviously we are not going to cover all of these capabilities that Istio provides in a single blog, so this blog will only consist an overview about Istio, what istio is, what data plane and control plane are, the istio architecture, and istio routing capabilities (The theoric side). The hands on lab part will be publish in other post and to be very specific each capabilities that istio support (istio 1.9 at the time of this post) will have its own blog so I could explain a step by step sample. 



## What is a Service Mesh?

A service mesh is a configurable, low‑latency infrastructure layer designed to handle a high volume of network‑based interprocess communication among application infrastructure services. A service mesh ensures that communication among containerized and often ephemeral application infrastructure services is fast, reliable, and secure. The mesh provides critical capabilities including service discovery, load balancing, encryption, observability, traceability, authentication and authorization, and support for the circuit breaker pattern.

In simple words a service mesh is in charge of solving the network drawbacks that microservices generates, the purpose of a service mesh tool is that developers are aware more about improving or building  business logic (which gives more value to the business) and not wasting time in network or infraestructure concerns.

Of course Istio is not the only service mesh solutions that exists out there, there a couple of them like consul mesh, linkerd, kuma, etc; but Istio is the most used service mesh at the time writting of this blog.   


## Architecture

A service mesh usually is compose for two components which are control plane and data plane, the control plane is in charge of distribute all the rules that we create across the service mesh (literally it brings al config to every data plane component), the data plane in other side is the "ant worker" of the service mesh since it is the component that routes, secures, authenticates and authorize every request that we configure (the data plane receives this config from de control plane);  the data plane is usually located next to the applications (this is the sidecar pattern) since every input or output request will go through this sidecar. 


![_config.yml]({{ site.baseurl }}/images/istio_service_mesh.jpg)
 

### Control Plane in Istio



### Data Plane in Istio

Istio data plane is composed by two components Envoy and Istio Agent, envoy (a L4/L7 performant load balancer written in c++) is used to handle all inbound or outbound traffic of the applications, the Istio agent in for its part is in charge of boostraping the envoy component.

Mention apart for envoy, the functionality of envoy depends on configurations, basically you set a port which envoy will listen to receive the request and also you can configure the rules that envoy should takes (retries, route based on path or headers, etc) , what I said before sounds easy and in fact configure envoy is not complicated at all, the part that is complicated of envoy is how to configure to update any rules on the fly, without the need to restart envoy; The control plane plays an important part for this needs because it is responsible to update any configuration that we made to the mesh (to do that istio uses the XDS service discovery that envoy support) without restarting envoy.


![_config.yml]({{ site.baseurl }}/images/istio_architecture.jpg)


## Istio Networking capabilities


###  Traffic Routing


###  Service-to-Service security communication


### Mutual TLS


### Authentication Filter


![_config.yml]({{ site.baseurl }}/images/istio_jwt_ingressgateway.jpg)


## References


